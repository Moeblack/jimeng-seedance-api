
# 前端增强：删除任务 & 伪进度条

## 目标
1.  **删除任务记录**：允许用户手动删除任务列表中的记录，用于清理“僵尸任务”或整理历史。同时尝试清理对应的 IndexedDB 缓存。
2.  **伪进度条**：为 `pending` 和 `processing` 状态的任务展示基于时间的估算进度条。
    *   视频任务估算时长：5分钟 (300秒)
    *   图片任务估算时长：30秒
    *   进度上限：99.9% (若超时未完成则卡在此处)

## 改动详情 (index.html)

### 1. 逻辑层 (JavaScript)
*   **MediaCache**: 新增 `remove(url)` 方法，用于从 IndexedDB 删除特定 Blob。
*   **状态管理**:
    *   新增 `currentTime` (ref)，配合 `setInterval` 每秒更新一次，用于驱动进度条和耗时显示的实时刷新。
    *   提取 `updateStats()` 方法，供 `fetchTasks` 和 `deleteTask` 复用。
*   **新功能函数**:
    *   `deleteTask(taskId)`: 弹出确认框 -> 删除 IndexedDB 缓存 -> 从 `tasks` 列表中移除 -> 更新统计。
    *   `getFakeProgress(task)`: 计算 `(now - created_at) / expected_duration`，返回百分比字符串（保留1位小数），上限 99.9%。
    *   优化 `getElapsed(task)`: 使用响应式的 `currentTime` 替代 `Date.now()`，确保界面时间动态跳动。

### 2. 视图层 (HTML)
*   **进度条**: 将原本绑定 `task.progress` 的进度条改为绑定 `getFakeProgress(task)`。
*   **操作按钮**: 在任务详情面板（Task Details）中，"View Result" 按钮旁新增 "Delete Record" 按钮（深红色文本）。

## 部署步骤
1.  修改本地 `index.html`。
2.  `scp` 部署到远程服务器 `moeblack@10.0.0.63`。
3.  同步更新 `jimeng-async-ui` 独立仓库并推送。

## 验证
*   刷新页面，新建一个任务，观察进度条是否随时间平滑（或每秒）增长。
*   等待超过估算时间，确认进度条卡在 99.9%。
*   选中一个任务，点击 "Delete Record"，确认任务从列表中消失，且统计数字更新。

## TODO LIST

<!-- LIMCODE_TODO_LIST_START -->
- [ ] 部署 index.html 到远程服务器  `#deploy-server`
- [ ] Index.html: 实现 MediaCache.remove, deleteTask, getFakeProgress, updateStats 逻辑  `#impl-logic`
- [ ] Index.html: 添加 currentTime 定时器以驱动实时更新  `#impl-timer`
- [ ] Index.html: 更新 HTML 模板（进度条绑定、删除按钮）  `#impl-view`
- [ ] 同步更新 jimeng-async-ui 仓库并推送  `#sync-repo`
<!-- LIMCODE_TODO_LIST_END -->
