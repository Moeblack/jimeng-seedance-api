
# 前端增强：模型补全 + 生成耗时 + 轮询设置 + 默认模型调整

所有改动仅涉及 `index.html`，无需后端变更。

## 一、改动清单

### 1. 默认模型调整
- **T2I**: `imageForm.model` 默认值 `'jimeng-4.5'` → `'jimeng-5.0'`，下拉列表中 `jimeng-5.0` 移到第一位
- **T2V**: `videoForm.model` 默认值 `'jimeng-video-3.5-pro'` → `'jimeng-video-seedance-2.0-fast'`

### 2. 补全 seedance-2.0-fast 模型选项
Video tab 的 `<select>` 中新增 `<option value="jimeng-video-seedance-2.0-fast">seedance-2.0-fast ⚡</option>` 并置于第一位

### 3. 轮询间隔用户设置
- **UI**: Configuration.exe 窗口中 Session ID 下方新增一行：`Poll (sec):` + `<select>` 下拉（3s / 5s / 10s / 15s / 30s），默认 5s
- **State**: `config` reactive 中新增 `pollInterval: 5`
- **持久化**: `onMounted` 读取 `localStorage.getItem('jm_poll_interval')`，`watch` 写入
- **生效**: `togglePolling()` 中 `setInterval(fetchTasks, (config.pollInterval || 5) * 1000)`
- **热更新**: `watch(config.pollInterval)` 变化时，如果正在轮询则 `clearInterval` + 重设新间隔

### 4. 生成耗时记录
- **新增方法 `getElapsed(task)`**：
  - 若 `completed/failed`：计算 `completed_at - created_at`（或 `updated_at` 回退）
  - 若进行中：计算 `now - created_at`（实时倒计时）
  - 输出格式：`12s` / `3m24s` / `1h5m`
- **任务列表行**: `[IMG] 21:30` 后追加 `{{ getElapsed(task) }}`
- **详情面板**: 新增 `Created:` 行显示完整时间，`Elapsed:` 行显示耗时（仅已完成时显示）

## 二、具体代码改动位置

| 行范围 (约) | 改什么 |
|---|---|
| 305-308 | Config window-body 中新增 Poll interval 下拉 |
| 343-350 | Image model select：jimeng-5.0 移到第一位，去掉 (Default) |
| 384-391 | Video model select：新增 seedance-2.0-fast 并置顶，去掉 3.5-pro 的 (Default) |
| 444-446 | Task header span：追加 `{{ getElapsed(task) }}` |
| 461-462 | Task details：新增 Created / Elapsed 两行 |
| 616-619 | config reactive：新增 `pollInterval: 5` |
| 632 | imageForm.model 默认值改为 `'jimeng-5.0'` |
| 639 | videoForm.model 默认值改为 `'jimeng-video-seedance-2.0-fast'` |
| 780 | togglePolling 中 setInterval 使用 `config.pollInterval` |
| 886-897 | 新增 `getElapsed()` 方法 |
| 903-906 | onMounted 中读取 `jm_poll_interval` |
| 919-921 | 新增 watch config.pollInterval 持久化 + 热更新 |
| 933 | return 中暴露 `getElapsed` |

## 三、部署

```bash
scp index.html moeblack@10.0.0.63:~/jimeng-api/index.html
```

刷新浏览器即生效。

## TODO LIST

<!-- LIMCODE_TODO_LIST_START -->
- [ ] Video 下拉新增 jimeng-video-seedance-2.0-fast 选项  `#add-fast-model`
- [ ] T2I 默认改为 jimeng-5.0，T2V 默认改为 seedance-2.0-fast，调整下拉列表顺序  `#default-models`
- [ ] scp 部署到远程服务器  `#deploy`
- [ ] 实现 getElapsed() 耗时计算方法  `#elapsed-method`
- [ ] 任务列表行和详情面板中显示生成耗时  `#elapsed-ui`
- [ ] 轮询间隔持久化 + 热更新逻辑  `#poll-interval-logic`
- [ ] Configuration 窗口新增 Poll interval 下拉选择器 (3/5/10/15/30s)  `#poll-interval-ui`
<!-- LIMCODE_TODO_LIST_END -->
